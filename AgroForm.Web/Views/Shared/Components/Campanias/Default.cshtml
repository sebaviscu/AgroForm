@using AgroForm.Model
@model List<Campania>

<div class="dropdown">
    <button class="btn btn-outline-secondary dropdown-toggle d-flex align-items-center w-100 justify-content-between py-2"
            type="button" id="campañasDropdown" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="ph ph-calendar me-2"></i>
        <span id="campañaActualText">
            @{
                var campañaActual = Model?.FirstOrDefault(c => c.EstadosCamapaña == EnumClass.EstadosCamapaña.EnCurso);
                var texto = campañaActual?.Nombre ?? "Seleccionar Campaña";
            }
            @texto
        </span>
    </button>
    <ul class="dropdown-menu dropdown-menu-start shadow border-0" aria-labelledby="campañasDropdown">
        @if (Model != null && Model.Any())
        {
            foreach (var campaña in Model)
            {
                <li>
                    <a class="dropdown-item d-flex justify-content-between align-items-center campaña-item @(campaña.EstadosCamapaña == EnumClass.EstadosCamapaña.EnCurso ? "active" : "")"
                       href="#" data-campaña-id="@campaña.Id">
                        <div>
                            <div class="fw-semibold">@campaña.Nombre</div>
                            <small class="text-muted">@campaña.FechaInicio.ToShortDateString()</small>
                        </div>
                        @if (campaña.EstadosCamapaña == EnumClass.EstadosCamapaña.EnCurso)
                        {
                            <i class="ph ph-check-circle-fill text-primary"></i>
                        }
                    </a>
                </li>
            }
            <li><hr class="dropdown-divider"></li>
        }
        <li>
            <a class="dropdown-item text-primary" href="@Url.Action("Index", "Campania")">
                <i class="ph ph-gear me-2"></i>Gestionar Campañas
            </a>
        </li>
    </ul>
</div>

<script src="~/js/views/selectorCampania.js" asp-append-version="true"></script>